<!doctype html>
<html>
    <head>
        <meta http-equiv="content-type" content="text/html; charset=UTF-8" />
        <title>plugdata - Download</title>
        <link
            rel="icon"
            type="image/x-icon"
            href="https://plugdata.org/images/favicon.ico"
        />
        <link rel="stylesheet" href="download_files/font-awesome.min.css" />
        <link rel="stylesheet" type="text/css" media="all" href="./main.css" />
        <link
            rel="stylesheet"
            type="text/css"
            media="all"
            href="./downloads.css"
        />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
    </head>

    <body style="background: rgb(255, 255, 255)">
        <nav>
            <script type="text/javascript">
                function toggleMenu() {
                    var e = document
                        .getElementById("menu-button")
                        .getAttribute("aria-expanded");
                    (e = "true" == e ? "false" : "true"),
                        document
                            .getElementById("menu-button")
                            .setAttribute("aria-expanded", e);
                }
            </script>
            <button
                class="menu-button enabled"
                title="Toggle navigation menu"
                aria-label="Toggle navigation menu"
                aria-expanded="false"
                id="menu-button"
                onclick="toggleMenu()"
            >
                <svg
                    aria-hidden="true"
                    height="24"
                    width="24"
                    xmlns="http://www.w3.org/2000/svg"
                >
                    <path d="M0 6v1h24V6zm0 6v1h24v-1zm0 6v1h24v-1z"></path>
                </svg>
            </button>
            <div class="nav-content">
                <ul>
                    <li>
                        <a href="https://plugdata.org/" class="logomark"
                            ><img
                                src="./images/logo.png"
                                alt="plugdata"
                                style="width: 24px; height: auto"
                        /></a>
                    </li>
                    <li><a href="https://plugdata.org/">Home</a></li>
                    <li>
                        <a href="https://plugdata.org/about.html" target="_self"
                            >About</a
                        >
                    </li>
                    <li>
                        <a href="https://plugdata.org/support.html">Support</a>
                    </li>
                    <li>
                        <a
                            href="https://plugdata.org/download.html"
                            target="_self"
                            >Download</a
                        >
                    </li>
                    <li>
                        <a
                            href="https://plugdata.org/documentation.html"
                            target="_self"
                            >Documentation</a
                        >
                    </li>
                </ul>

                <style>
                    .social {
                        display: inline-block;
                        cursor: pointer;
                        margin-right: 12px;
                    }

                    .logo {
                        display: inline-block;
                        height: 28px;
                        width: auto;
                        position: relative;
                        margin-right: -8px;
                        top: 8px;
                    }
                </style>

                <div class="right">
                    <div
                        class="social"
                        onclick="location.href = 'https://github.com/plugdata-team/plugdata';"
                    >
                        <img src="./images/github.png" class="logo" />
                        <a>View on GitHub</a>
                    </div>

                    <div
                        class="social"
                        onclick="location.href = 'https://discord.gg/eT2RxdF9Nq';"
                    >
                        <img src="./images/discord.png" class="logo" />
                        <a>Join our Discord</a>
                    </div>
                </div>
            </div>
        </nav>
        <h2
            style="
                text-align: center;
                font-family: Inter;
                font-weight: 700;
                border-radius: 0%;
                border: medium none;
                outline: none;
                font-size: 48px;
                color: rgb(51, 51, 51);
                background-color: transparent;
                margin-top: 70px;
            "
        >
            Download plugdata
        </h2>
        <h1
            style="
                top: 50px;
                text-align: center;
                font-family: Inter;
                font-weight: 500;
                padding-top: 20px;
                padding-bottom: 20px;
                font-size: 32px;
                color: rgb(51, 51, 51);
                background-color: transparent;
            "
        >
            Latest stable (v0.9.1)
        </h1>
        <section class="docs">
            <div class="card" target="_blank">
                <img class="os_logo" src="./images/windows.svg" alt="Windows" />
                <div class="download_container">
                    <div class="download_text">Windows (x64)</div>
                    <a
                        class="download_button"
                        href="https://github.com/plugdata-team/plugdata/releases/download/v0.9.1/plugdata-Win64.msi"
                        >Download</a
                    >
                </div>
                <div class="download_container">
                    <div class="download_text">Windows (x86)</div>
                    <a
                        class="download_button"
                        href="https://github.com/plugdata-team/plugdata/releases/download/v0.9.1/plugdata-Win32.msi"
                        >Download</a
                    >
                </div>
                <div style="font-size: 12px; margin-top: 60px">
                    Requires Windows 7 or later.
                </div>
            </div>
            <div class="card" target="_blank">
                <img class="os_logo" src="./images/macos.svg" alt="macOS" />
                <div class="download_container">
                    <div class="download_text">macOS Universal</div>
                    <a
                        class="download_button"
                        href="https://github.com/plugdata-team/plugdata/releases/download/v0.9.1/plugdata-macOS-Universal.pkg"
                        >Download</a
                    >
                </div>
                <div class="download_container">
                    <div class="download_text">macOS Legacy</div>
                    <a
                        class="download_button"
                        href="https://github.com/plugdata-team/plugdata/releases/download/v0.9.1/plugdata-macOS-Legacy.pkg"
                        >Download</a
                    >
                </div>
                <div class="download_container">
                    <div class="download_text">Homebrew Cask</div>
                    <a
                        class="download_button"
                        href="https://formulae.brew.sh/cask/plugdata"
                        >View</a
                    >
                </div>
                <div style="font-size: 12px; margin-top: 50px">
                    Homebrew package is unofficial and may be outdated. Choose
                    macOS Universal for macOS 10.15 or later. Choose macOS
                    Legacy for macOS 10.11 or later.
                </div>
            </div>
            <div class="card" target="_blank">
                <img class="os_logo" src="./images/linux.svg" alt="Linux" />
                <div class="download_container">
                    <div class="download_text">Repositories</div>
                    <a
                        class="download_button"
                        href="https://software.opensuse.org//download.html?project=home%3Aplugdata&package=plugdata"
                        >View</a
                    >
                </div>
                <div class="download_container">
                    <div class="download_text">Arch AUR Repository</div>
                    <a
                        class="download_button"
                        href="https://aur.archlinux.org/packages/plugdata-bin"
                        >View</a
                    >
                </div>
                <div class="download_container">
                    <div class="download_text">More downloads</div>
                    <a
                        class="download_button"
                        href="https://github.com/plugdata-team/plugdata/releases/tag/v0.9.1"
                        >View</a
                    >
                </div>
            </div>
        </section>

        <h1
            style="
                top: 50px;
                text-align: center;
                font-family: Inter;
                font-weight: 500;
                padding-top: 20px;
                padding-bottom: 20px;
                font-size: 32px;
                color: rgb(51, 51, 51);
                background-color: transparent;
            "
        >
            Latest nightly
        </h1>
        <div class="table-container">
            <table id="nightly-table">
                <tr>
                    <th>Platform</th>
                    <th>Date</th>
                    <th>Commit</th>
                    <th>Download</th>
                </tr>
                <!-- Add more rows as needed -->
            </table>
        </div>

        <div id="nightly-div" style="margin: 15px"></div>
        <script type="text/javascript">
            function main() {
                let unstable_downloads = [
                    [
                        "macOS Universal",
                        "https://storage.googleapis.com/plugdata-nightly/plugdata-macOS-Universal.pkg",
                        "Download",
                        true,
                    ],
                    [
                        "macOS Legacy",
                        "https://storage.googleapis.com/plugdata-nightly/plugdata-macOS-Legacy.pkg",
                        "Download",
                        true,
                    ],
                    [
                        "Windows (x64)",
                        "https://storage.googleapis.com/plugdata-nightly/plugdata-Win64.msi",
                        "Download",
                        true,
                    ],
                    [
                        "Windows (x86)",
                        "https://storage.googleapis.com/plugdata-nightly/plugdata-Win32.msi",
                        "Download",
                        true,
                    ],
                    [
                        "Arch (x64)",
                        "https://storage.googleapis.com/plugdata-nightly/plugdata-Arch-x64.tar.gz",
                        "Download",
                        true,
                    ],
                    [
                        "Debian (x64)",
                        "https://storage.googleapis.com/plugdata-nightly/plugdata-Debian-x64.tar.gz",
                        "Download",
                        true,
                    ],
                    [
                        "Fedora 39 (x64)",
                        "https://storage.googleapis.com/plugdata-nightly/plugdata-Fedora-39-x64.tar.gz",
                        "Download",
                        true,
                    ],
                    [
                        "Fedora 40 (x64)",
                        "https://storage.googleapis.com/plugdata-nightly/plugdata-Fedora-40-x64.tar.gz",
                        "Download",
                        true,
                    ],
                    [
                        "Ubuntu 22.04 (x64)",
                        "https://storage.googleapis.com/plugdata-nightly/plugdata-Ubuntu-22.04-x64.tar.gz",
                        "Download",
                        true,
                    ],
                    [
                        "Ubuntu 24.04 (x64)",
                        "https://storage.googleapis.com/plugdata-nightly/plugdata-Ubuntu-24.04-x64.tar.gz",
                        "Download",
                        true,
                    ],
                    [
                        "OpenSUSE Tumbleweed (x64)",
                        "https://storage.googleapis.com/plugdata-nightly/plugdata-OpenSUSE-Tumbleweed-x64.tar.gz",
                        "Download",
                        true,
                    ],
                    [
                        "Arch Linux AUR Repository",
                        "https://aur.archlinux.org/packages/plugdata-git",
                        "View",
                        false,
                    ],
                ];

                let unstable_container = document.getElementById("nightly-div");
                unstable_container.style.margin = "15px";

                let onHashUpdate = [];

                let latest_hash = "";
                const getLatestHash = async () => {
                    fetch(
                        `https://api.github.com/repos/plugdata-team/plugdata/commits/develop`,
                    )
                        .then((response) => response.json())
                        .then((data) => {
                            latest_hash = data.sha;
                            console.log("Last Commit Hash:", latest_hash);
                            for (let i = 0; i < onHashUpdate.length; i++) {
                                onHashUpdate[i]();
                            }
                        })
                        .catch((error) => console.error("Error:", error));
                };

                const table = document.getElementById("nightly-table");

                for (let i = 0; i < unstable_downloads.length; i++) {
                    const downloadRow = document.createElement("tr");

                    let name = document.createElement("td");
                    name.textContent = unstable_downloads[i][0];

                    let link = document.createElement("td");
                    let clickableLink = document.createElement("a");

                    clickableLink.href = unstable_downloads[i][1];
                    clickableLink.textContent = unstable_downloads[i][2];
                    link.appendChild(clickableLink);

                    let has_info = unstable_downloads[i][3];

                    const dummy1 = document.createElement("td");
                    const dummy2 = document.createElement("td");

                    downloadRow.appendChild(name);
                    downloadRow.appendChild(dummy1);
                    downloadRow.appendChild(dummy2);
                    downloadRow.appendChild(link);

                    const getDownloadInfo = async () => {
                        let url = unstable_downloads[i][1] + ".txt";
                        console.log(url);
                        let response = await fetch(url);
                        const result = await response.text().then((str) => {
                            return str.split("\n"); // return the string after splitting it.
                        });

                        // Create new cells and set their content
                        const date = document.createElement("td");
                        date.textContent = result[0];
                        date.style.minWidth = "200px";

                        const hash = result[1];
                        let color = hash == latest_hash ? "#006400" : "#FFA500";

                        const commit_hash = document.createElement("td");
                        const commit_link = document.createElement("a");

                        commit_link.textContent = hash.substring(0, 7);
                        commit_link.style.cssText = `color: ${color}`;
                        commit_link.href =
                            "https://github.com/plugdata-team/plugdata/commits/" +
                            hash;
                        commit_hash.appendChild(commit_link);

                        onHashUpdate.push(() => {
                            let color =
                                hash == latest_hash ? "#006400" : "#FFA500";
                            commit_hash.style.cssText = `color: ${color}`;
                            console.log(
                                hash == latest_hash
                                    ? "hash was equal"
                                    : "hash was not equal",
                            );
                        });

                        downloadRow.removeChild(name);
                        downloadRow.removeChild(dummy1);
                        downloadRow.removeChild(dummy2);
                        downloadRow.removeChild(link);

                        // Append the cells to the row
                        downloadRow.appendChild(name);
                        downloadRow.appendChild(date);
                        downloadRow.appendChild(commit_hash);
                        downloadRow.appendChild(link);
                    };

                    if (has_info) {
                        getDownloadInfo();
                    }

                    // Append the row to the table
                    table.appendChild(downloadRow);
                }

                getLatestHash();
            }

            main();
        </script>

        <footer>
            <div>
                <p>Copyright Â© 2023 Timothy Schoen.</p>
            </div>
            <ul>
                <li><a href="https://plugdata.org/">Home</a></li>
                <li>
                    <a href="https://plugdata.org/about.html" target="_self"
                        >About</a
                    >
                </li>
                <li><a href="https://plugdata.org/support.html">Support</a></li>
                <li>
                    <a href="https://plugdata.org/download.html" target="_self"
                        >Download</a
                    >
                </li>
                <li>
                    <a
                        href="https://plugdata.org/documentation.html"
                        target="_self"
                        >Documentation</a
                    >
                </li>
            </ul>
        </footer>
    </body>
</html>
